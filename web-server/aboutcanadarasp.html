<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 5.0 FINAL//EN">
<html>
<head>
  <title>About Canada RASP</title>
  <meta http-equiv="Content-Type" content="text/html;charset=US-ASCII" >
  <meta HTTP-EQUIV="Content-Script-Type" content="text/javascript">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
</head>
<body>
  <h2>About Canada RASP</h2>
   This site provides two types of visualizations from the output of the continental
  run of the High Resolution Deterministic Prediction System
  (<a href="https://weather.gc.ca/grib/grib2_HRDPS_HR_e.html">HRDPS</a>),
  a weather model run by Environment and Climate Change Canada as well as the Global Determinstic Prediction System (<a href ="https://weather.gc.ca/model_forecast/global_e.html">GDPS</a>).  The most popular visualization is a <b><a href="/windgrams">windgram</a></b> which shows wind and temperature at a single lat/lon location as a function of altitude over the next one or two days.  The main page is the <b><a href="/">maps</a></b> page which show a single piece of information about the atmosphere overlaid on a map (for example, the wind at 1500m).  Limited documentation can be found <a href="parameterdescription.html">here</a>.  If there is a location for which you would like a windgram added, contact <a href="mailto:ajberkley@gmail.com"> Andrew Berkley</a> or use the dynamic windgram generator.<p>


	  <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
	    <input type="hidden" name="cmd" value="_s-xclick">
	    <input type="hidden" name="hosted_button_id" value="R3QEBDRXCZNUW">
	    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" opacity="100" class="showme">
	    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
	  </form>
<p>
<b>Update 2023:</b> This site is supported by donations from users.  Please consider donating if you use this for fun or for work by clicking the donate button above.  Since this site went online, I have always received less donations each year than the costs of running the site on AWS (about $1500/year), not to mention my time in developing and maintaining this site.  I am not an active paraglider pilot anymore so my motivation to pay out of pocket and to support this is also gradually waning.  So consider this an honest assessment of how I feel: <font color="red">this site is in danger of going away</font>.  I know first hand that good weather visualization improves safety for paraglider pilots and I'd hate to just stop running this site and have someone get hurt because of it, but I can't keep paying out of pocket every year to run this and throwing away weekends keeping it going.
<p>
  This page was initially developed
  by <a href="mailto:ajberkley@gmail.com">Andrew Berkley</a> and Peter
  Spear.  Our main motivation was as paraglider pilots: we wanted to know
  what the weather is going to do so we can go flying more often.
  Thus, this page is a result of unflyable weather.
  
  Upgrades to support the full HRDPS continental model and GDPS model
  and maintainance since then is by Andrew Berkley.<p>

  Canada RASP (Regional Atmospheric Soaring Predictor) uses data from the Environment and Climate Change Canada <a href="http://www.weatheroffice.gc.ca/grib/grib2_HRDPS_HR_e.html">HRDPS</a> model, made available freely by the Government of Canada.<p>


  Some of my favorite other weather visualization sites:
  <ul>
    <li> <a href="https://www.wxcharts.com/">WX Charts</a> </li>
    <li> <a href="https://www.ventusky.com/">Ventusky</a> </li>
    <li> <a href="https://www.windy.com/">Windy</a> </li>
    <li> <a href="https://spotwx.com/">Spot Wx</a> </li>
    <li> <a href="https://xcskies.com/">XC Skies</a> (a pay site) </li>
    
  </ul>
  <h2>Changelog/updates</h2>
  <b>11 Mar 2023 ajb</b> GDPS is fixed.  Thank you to the Vancouver Island and Vancouver area pilots for your support!<p>
  <b>11 Feb 2023 ajb</b> GDPS is currently disabled, will try and fix this weekend.<p>
  <b>5 Feb 2023 ajb</b> CAPE, sfcwind at 40m and 120m are not currently working (they will be fixed next run).  GDPS did not run today.  Fixing it.<p>
  <b>Jan/Feb 2023 ajb</b> ECCC deprecated the HRDPS data source we were using (data on a polar stereographic grid).  I spent about a week of work updating things to work with the new data (the main problem was that wgrib2 small_grib option did not work with the new data format but their developers quickly fixed the problem (but things run slowly now, for reasons I have not had time to dig into but will increase costs significantly until I do).  Then I had to upgrade some libraries including libgdal to support the new format, which had a breaking change between 2 and 3 which took some time to discover.  I took the time to upgrade the system software on the processing machine too.  There should be no user visible changes except there is slightly more coverage for Alaska and northern Yukon.  If something does not work, please <a href="mailto:ajberkley@gmail.com">email me</a>.  I also added a new donate button on the main page because this site is in danger of going away.  I am not an active paraglider pilot, and the donations I receive do not cover the costs of running this site not to mention cover my time in keeping it working (for example this week of work).  Please consider donating. --Andrew<p>
  <b>23 Nov 2022 ajb</b> Put source code for Canadarasp online at <a href="https://github.com/ajberkley/canadarasp">github</a>.  To do so required some fiddling with the backend so I didn't expose some non-restricted API keys which broke windgram generation for a couple days.  Fixed.  Anyhow, in case I get hit by a bus there it is.  ECCC is changing their data location / grid format in Feb 2023 so I have to fix that before then. --Andrew<p>
  <b>23 June 2021 ajb</b> AWS services are not working problem so system is not updating... hoping AWS fixes this soon.  I paid some money to get some support and they are working on fixing this.  Should be working soon. It took them all morning but they fixed it. --Andrew<p>
  <b>8 September 2020 ajb</b> Fixed bug in map windgram selector where links to windgrams would not work --Andrew<p>
  <b>2 September 2020 ajb</b> Changed the error messages for the dynamic windgram generator as they might have been confusing.  When generating single day windgram provide links to other days in case you did not choose the date in the date/time picker before long-clicking.  The previous links work fine and still just return the image. --Andrew<p>
  <b>31 August 2020 ajb</b> Some general code clean-up and sped up the back end processing a bit.  There should be no user visible changes. --Andrew<p>
  <b>24 July 2020 ajb</b> The data for this evening run seems corrupted and the windgrams did not run.  The map overlay plots have the latest run data though so you can get the information you need there (initialized 18Z).  Hopefully this is a one off issue with Environment Canada, otherwise I will work on fixing it this weekend. --Andrew<p>
  <b>24 November 2019 ajb</b> Added some automated monitoring so I don't have to rely on people to alert me when things go down. --Andrew<p>
  <b>30 October 2019 ajb</b> Switched back to original Environment Canada download service.  Hopefully this will fix things. --Andrew<p>
  <b>29 October 2019 ajb</b> Environment Canada download service seems slow, rasp updates may not happen or be delayed.  Seems this always correlates with flyable weather.  No more information at this time. --Andrew<p>
  <b>26 October 2019 ajb</b> Seems to be working again.  I also fixed the GDPS which I broke this time while switching to the 15 km grid. --Andrew<p>
  <b>24 October 2019 ajb</b> Environment Canada download service is broken.  No more information at this time. --Andrew<p>
  <b>21 October 2019 ajb</b> Ooops, was plotting the wind gusts in the wrong units.  They should make a lot more sense now.  Wind gust is a reasonable estimate of the maximum wind speed at the ground. --Andrew<p>
  <b>20 October 2019 ajb</b> Some cleanups --- keep state properly for model and other checkboxes.  I'm still not really sure what wind gust encodes --- it appears to be the gust above base surface wind at 10m --Andrew<p>
  <b>19 October 2019 ajb</b> Added maximum predicted wind gust at the surface and fixed terrain height map for HRDPS, and update documentation slightly.  --Andrew<p>
  <b>19 October 2019 ajb</b> Upgraded to the 15 km GDPS data.  This should generate better maps and more accurate windgrams.  --Andrew<p>
  <b>4-5 October 2019 ajb</b> Updates were broken for one day due to operator error.  Fixed.  I also made dynamic windgrams default to one day, you can select two days in the left hamburger menu at the bottom.  It will do a one day windgram for the day selected in the date selector. --Andrew<p>
  <b>10 August 2019 ajb</b> My fix below seems to have broken the evening runs ... fixed.  Please notify me if anything weird is going on! --Andrew<p>
  <b>4 August 2019 ajb</b> Found that some windgrams were not being generated for one of either the morning or evening runs for sites east of BC due to time issues... hopefully fixed, will see tomorrow morning--Andrew<p>
  <b>9 July 2019 ajb</b> Replaced the google timezone api with a local service (seriously, how can Google be charging 0.5 cents per hit for such a trivial service) --Andrew<p>
  <b>1 July 2019 ajb</b> I temporarily disabled usage of the google maps timezone api as they changed their billing on it and it now costs too much to use the way I was using it.  I will have to come up with a better solution as the timezones on the maps page are now incorrect (doesn't do DST right, etc). --Andrew<p>
  <b>28 June 2019 ajb</b> System was down yesterday and this morning, should be up and running reliably again. --Andrew<p>
  <b>26 June 2019 ajb</b> After being alerted by a user, I found that the no-cache assertions for the windgram pages had been broken since I switched web servers a long time ago.  Fixed.  Now you should get the newest windgram by a simple refresh (as opposed to having to press ctrl-shift-r in chrome. --Andrew<p>
  <b>23 May 2019 ajb</b> I broke the RASP system yesterday after upgrading one of the machines.  Should be back up and running again already.  --Andrew<p>
  <b>20 May 2019 ajb</b> The ECCC data issues seem resolved.  The remaining stability issues are related to AWS EC2 issues with drive attachment being unreliable.  Any EC2 experts out there want to help? --Andrew<p>
  <b>7 May 2019 ajb</b> I gave a webinar to ECCC recently --- the main interest I got from them is that they want feedback on predictions.  Are winds overpredicted? underpredicted? (they say the HRDPS underpredicts winds when they are strong).  Anyway, an interesting time.  I will be looking into their GeoMet services to reduce processing I have to do to generate the maps --Andrew<p>
  <b>Mar/Apr 2019 ajb</b> ECCC is once again having data transfer issues.  This seems to affect the morning runs more than the evenings.  I am experimenting with a new service they announced in early April which may make things work better.  See <a href="/data-issues.html">here</a> for updates from me about it.<p>
  <b>16/17 March 2019 ajb</b> Got sick of the interface looking like it was from the 80s.  Changed it.  Now it still looks like it is from the 80s but with animations.  I just have no skills with user interface design.  You can get to the old interface by clicking the Old Map Interface link in the left menu<p>
  <b>13-15 March 2019 ajb</b> We've been having some trouble getting data from the models --- ECCC is looking into the issue.<p>
  <b>13 March 2019 ajb</b> Added a new BC archive (look under the models menu in the top center) which will keep data for a year or two for the wind maps.  Been having some trouble with AWS this week, resulted in some delayed and broken runs.  Hopefully it's fixed.<p>
  <b>18 November 2018 ajb</b> Moved the alpha runs to production -- you now have global coverage available on www.canadarasp.com.  I haven't plugged in any windgrams globally as I don't find them that useful unfortunately.  You can look at them by selecting GDPS from the windgram page.  I'd be happy to add some of our global flying spots that aren't already covered by a RASP site.  <s>You can access the old infrastructure at old.canadarasp.com for the next couple weeks in case something goes wrong.</s> <p>
<b>Oct - Nov 2018 ajb</b>  Added global GDPS model to alpha.canadarasp.com.  Modified map and windgrams to use local time not fixed pacific time.  Slight changes to interface.<p>
<b>9 September 2018 ajb</b> Shutdown old.canadarasp.com and the old generation infrastructure.  Added dynamic windgram generation to <a href="http://www.canadarasp.com/windgrams-continental/select-windgram.htm">windgram selector page</a>, changed map interface for dynamic windgrams from an enable checkbox to a long press on the map surface.  Please send me any feedback you have... it's a long winter coming up.<p>
<b>6 September 2018 ajb</b> Fixed surface dewpoint (I am plotting dew point depression in the new maps), resurrected the average thermal strength plot.  Did final comparision versus the previous production runs.  Moved the main website to my new Amazon webserver and have rolled out what was the alpha code to production.  <del>The old maps and windgrams will continue to run on <a href="http://old.canadarasp.com">old.canadarasp.com</a> for a few more days until I'm sure everything is working well, and then they will be shut down.</del><p>
<b>3 September 2018 ajb</b> Better wind arrow drawing, scales as you zoom a bit. Working on clipping wind to terrain.  Got the rain map back and switched surface pressure map to the correct source (surface pressure MSL).  DNS service is now Amazon.  www.canadarasp.com is the old production server, and alpha.canadarasp.com is the new testing domain.  I will switch the alpha to production in a few days after I make sure the latest changes are stable.</p>
<b>2 September 2018 ajb</b> Added a dynamic windgram generator.  <del>Click the dynamic windgram box, then click a place on the map...</del>Press and hold on the map... only works for places near other existing windgrams.  I'm improving the back end so all tiles will be covered. Also added a windgram for Yamaska, Quebec to try and get the new folks from the central and eastern parts of Canada into using this site.<p>
<b>28 August 2018 ajb</b> I'm in the process of moving my webserver from Go Daddy to Amazon...<p>
<b>25 August 2018 ajb</b> Moved wind direction drawing to client, reduces compute requirements on server side which frees up space and time for loading other model data in the future.<p>
<b>23 August 2018 ajb</b> Added coverage for all of Canada and the northern parts of the United States! This required a huge amount of back-end work (mainly to make the processing fast enough so as not to drive me broke with Amazon EC2 costs). This should enable me to add NAM3, HRRR, and GFS model output data and on-demand windgram generation for any location and model (this will cost some extra money to keep the data around, but it doesn't look too bad). I replaced the crusty old NCL map generator with some 10x faster Common Lisp code (my language of choice) with the GIS part handled by GDAL and graphics generation by my new Lisp code. I use eccodes, cl-png, cl-gd, cl-gdal, and libgd. Currently the winds are not getting clipped to terrain properly and there is no rain map... <del>will fix soon!</del> fixed<p>
  <b>7 August 2018 ajb </b> For tomorrow's run: fixed surface dewpoint. Added boundary layer depth, average thermal velocity, and cloudbase. Added a parameter description page.<p>
  <b>5 August 2018 ajb</b> Added a map of expected top of lift above ground.
  This is similar to the height the paragliders get drawn on on the windgrams.
  I'm thinking this indicator is a bit pessimistic.  I will get the boundary
  layer height map on soon which will be the most optimistic.  This top of lift
  indicator ignores cloud suck and ridge lift and uses a model for the shape of
  thermals and their lift distribution versus altitude.  I think we can probably
  do better.  On some days with a slightly inverted layer the top of lift can
  be very sensitive to ground heating.  You have to look at the windgrams to see
  and judge yourself.  I can add a sensitivity map too (ie assume ground temperatures
  are 0.5C higher or lower), but in the end these are just meant to give you a rough
  indicator of soarability.<p>
  <b>5 July 2018 ajb</b> The old windgram generator failed to run today, so I
  switched everyone over to the new one.  There is now only the new page
  running.  Old bookmarks will work fine, but the map interface will be the
  new one only.  Remember to check the bottom left corner of each windgram to
  be sure it is the newest one.<p>
  <b>3 July 2018 ajb</b> Another oops, windgrams were being generated in
  the wrong spot, so sorry if it put you off flying.  The old versions
  were fine (and most people link directly to them).<p>
  <b>2 July 2018 ajb</b> Oops, some windgrams were not being generated
  properly.  Fixed.  Also shrank back the clouds on the two day
  windgrams and got the time access colored properly and the pressure
  back to kPa.  Show windgrams checkbox is now persistent too (saved in
  bookmark).<p>
  <b>30 June 2018 ajb</b> The <a href="/"> tiled
  map viewer</a> is currently in beta test with all of you as my
  testers.  You can no longer access the old viewer and old windgrams.<p>
  <b>10 April 2018 ajb</b> Added a donate button.

    
  <h2>History</h2>

  Starting in 2013, this site ran very high resolution cloud resolving
  (400m) <a href="http://www2.mmm.ucar.edu/wrf/users/">WRF</a> models for the Pemberton, Fraser Valley, and Lumby areas
  nested inside the HRDPS west parent model.
  <p>
   Much of the starting code came from
  <a href="http://www.drjack.info/index.html">Dr. Jack
  Glendening's</a> RASP (regional atmospheric soaring predictor)
  project, but I decided to use a more modern version of WRF and
  needed to interface it all to the output of the HRDPS model for
  boundary and initial conditions so I ended up tearing most of the
  original parts apart and switching to a modern version
  of <a href="http://www2.mmm.ucar.edu/wrf/users/">WRF</a> and a
  different physics model to resolve clouds.  The initial bits for the
  map viewer came from Paul Scorer, a sailplane pilot in the UK.  The
  windgram code and assorted advice came from TJ Olney, a American
  paraglider pilot in Washington state.

  These WRF runs were very informative for understanding the details
  of wind and Whistler express events around the Pemberton, BC
  valleys. Unfortunately, it regularly over-predicted the winds in
  that area and thus resulted in pilots choosing not to fly when it
  was flyable.  I spent time trying to tweak the models and the
  topography to make it work better but the turn around time was so
  long to see if it made any difference that I eventually gave up and
  stopped running it in late 2014.  Plus, some of the computers
  running the model died.
<p>
  Then we were left with just visualizing the HRDPS output as it
  seemed to be quite accurate as an indicator for flyability and
  soarability in our local flying areas.
<p>
  From May to Sept 2018, I upgraded the system to handle the entire
  Pan-Canadian HRDPS model output as we were missing many of the pilots in the
  east and the north with the western only output.
  This takes a reasonable amount of
  computing power (this all runs on relatively big iron in Amazon
  EC2), so I am hoping my viewers consider donating.  The processing back
  end costs $1200 CAD/year, so $5/user/year would easily cover that.  It would also be nice to cover some of the development costs and be able to expand the system to handle a couple of the global models and the NAM3 for high resolution for the rest of the USA so you can have windgrams for sites you travel to.
<p>
  From Sept through Nov 2018, I worked on adding a global model (the GDPS) to the map and windgram system.  The windgrams are not as useful as I hoped for, but the wind / parameters maps are useful.  I'll see how there are when I travel south for the winter.  It should be easier to integrate the GFS (which I could do after they upgrade the GFS forecasting system in January 2019) and the NAM3 now (which I could start anytime).
<p>
  Early 2023 I had to get on the hamster wheel and change the data source and upgrade the processing pipeline because ECCC deprecated the data source I was using.
<p>
  Also, if you would like any windgram locations added (or you want to generate windgrams for an area that is not currently covered), please
  email <a href="mailto:ajberkley@gmail.com">me</a>.<p>

  <h2>Some possible changes</h2>
  <ol>
    <li>Add a jetstream map</li>
<li>
Add a map of cumulus cloud base (lifting condensation level).
<li>
Move away from google maps to something like Leaflet.
<li>
Add some more weather models: GFS for another global model and NAM3 and HRRR to cover with high resolution the rest of the United States of America.
<li>
Add more complete on-demand windgram generation (there is a limited implementation available off the main map page).  Add a better interface to this (context menu to select days, model, etc).
<li>
Maybe change to a prettier javascript front-end viewer like windy or ventusky.
If you are a web developer with a talent for making nice interfaces, I could sure use some help.
<li>
Also look more closely at better ways to present estimated top of lift with sensitivity information.
<li>
More compact output files for the map page and a smoother interface.
<li> Fix some minor bugs in the windgram generator (numbers in the wrong spot on the time axis and the color legend bar is a bit messed up sometimes).
<li> Add the PBL map that is now exposed directly from the HRDPS model
</ol>
</body>
